#!/bin/bash
# Git post-merge hook for AIKnowSys
# Auto-rebuilds context index when context files are merged from team

# Only rebuild if .md files in context directories changed
if git diff --name-only HEAD@{1} HEAD 2>/dev/null | grep -Eq '^\.aiknowsys/(plans|sessions|learned)/.*\.md$'; then
  echo "ðŸ”„ Context files merged, rebuilding index..."
  npx aiknowsys rebuild-index --quiet 2>/dev/null || node bin/cli.js rebuild-index --quiet 2>/dev/null || true
  echo "âœ… Context index updated after merge"
fi
